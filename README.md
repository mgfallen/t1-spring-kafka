# Metrics System

## Оглавление

1. [Metrics Producer](#metrics-producer)
   - [Описание](#описание)
   - [Компоненты](#компоненты)
   - [Настройка](#настройка)
   - [Методы API](#методы-api)
   - [Запуск](#запуск)
   - [Примеры использования](#примеры-использования)
   - [Тестирование](#тестирование)
2. [Metrics Consumer](#metrics-consumer)
   - [Описание](#описание-1)
   - [Компоненты](#компоненты-1)
   - [Настройка](#настройка-1)
   - [Методы API](#методы-api-1)
   - [Запуск](#запуск-1)
   - [Примеры использования](#примеры-использования-1)
   - [Тестирование](#тестирование-1)

## Metrics Producer

### Описание

`Metrics Producer` — микросервис для сбора метрик приложения и отправки их в Kafka топик `metrics-topic` для последующего анализа. Отслеживает использование ресурсов.

### Компоненты

- **KafkaMetricProducer**: Отправляет метрики в Kafka топик.
- **MetricService**: Собирает метрики и отправляет их через `KafkaMetricProducer`.
- **MetricDto**: DTO для представления метрик в формате JSON.

### Настройка

Настройте параметры подключения к Kafka в `application.yaml`.

### Методы API

- **POST /metrics**: Отправка метрик в Kafka.

### Запуск

1. Убедитесь, что Kafka брокер запущен и доступен.
2. Соберите проект с помощью Maven.
3. Запустите приложение.

### Примеры использования

Используйте `curl` или другой инструмент для отправки HTTP POST запросов к `/metrics`.

### Тестирование

Используются интеграционные тесты для контроллера, а также тесты, проверяющие логику пролюсера.

## Metrics Consumer

### Описание

`Metrics Consumer` — микросервис, который принимает метрики из Kafka топика `metrics-topic`, обрабатывает и анализирует их. Сервис позволяет просматривать метрики через REST API и может сохранять данные для дальнейшего анализа.

### Компоненты

- **KafkaMetricConsumer**: Обрабатывает метрики из Kafka топика.
- **MetricRepository**: Интерфейс для взаимодействия с базой данных, где сохраняются метрики.
- **MetricService**: Обрабатывает полученные метрики и предоставляет доступ через API.
- **MetricDto**: DTO для представления метрик в формате JSON.

### Настройка

Настройте параметры подключения к Kafka и базу данных в `application.properties`.

### Методы API

- **GET /metrics**: Получение списка всех метрик.
- **GET /metrics/{id}**: Получение конкретной метрики по идентификатору.

### Запуск

1. Убедитесь, что Kafka брокер запущен и доступен.
2. Соберите проект с помощью Maven.
3. Запустите приложение.

### Примеры использования

Используйте `curl` или другой инструмент для отправки HTTP GET запросов к `/metrics` и `/metrics/{id}`.

### Тестирование

Используйте интеграционные тесты для проверки получения и обработки метрик.
